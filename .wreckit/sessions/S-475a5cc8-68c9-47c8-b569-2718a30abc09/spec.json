{
  "spec": {
    "title": "Polymarket Aggregator Implementation Specification",
    "summary": "This specification addresses a critical data integrity bug in the order reconciler, deploys a Redis-backed async price cache with monitoring, completes backend integrations for Helius and Oracle, implements proxy wallet authentication, and updates project documentation.",
    "tickets": [
      {
        "id": "T-001",
        "title": "Fix order reconciliation logic in reconciler.ts",
        "implementationGuide": "1. Open `src/polymarket/reconciler.ts`. 2. Locate the unimplemented TODO comment. 3. Analyze the surrounding code to understand the expected data structure for order states and filled quantities. 4. Implement the logic to correctly calculate filled quantities based on order updates. 5. Ensure the logic handles edge cases such as partial fills and order cancellations. 6. Remove the TODO comment.",
        "filesLikelyChanged": [
          "src/polymarket/reconciler.ts"
        ],
        "testingNotes": "Write unit tests that mock order updates to verify filled quantities are calculated accurately. Run the test suite to ensure no regressions."
      },
      {
        "id": "T-002",
        "title": "Deploy and monitor async price cache (PR #156)",
        "implementationGuide": "1. Verify that PR #155 is merged into the main branch. 2. Review the code for PR #156 to ensure the Redis-backed cache (30s TTL, 15s background update) is correctly implemented. 3. Verify the `PRICES_ENABLED` kill switch logic. 4. Ensure the `/v1/prices/health` endpoint is implemented and returns the correct status. 5. Define and implement the fallback behavior for when Redis is unavailable. 6. Prepare deployment scripts for production.",
        "filesLikelyChanged": [
          "src/prices/cache.ts",
          "src/prices/health.ts",
          "docker-compose.yml",
          ".env.example"
        ],
        "testingNotes": "Deploy to staging first. Hit `/v1/prices/health` to confirm status. Simulate a Redis connection failure to verify fallback behavior. Monitor logs to ensure CLOB API calls are concurrency-limited."
      },
      {
        "id": "T-003",
        "title": "Update agent.md with market progress",
        "implementationGuide": "1. Open `agent.md`. 2. Create or update sections for 'Creator Flow', 'Liquidity Seeding', and 'Price Action Markets'. 3. Fill in the current status and progress for each section based on the project context. 4. Ensure the tone is consistent with existing documentation.",
        "filesLikelyChanged": [
          "agent.md"
        ],
        "testingNotes": "Review the document to ensure all requested updates are present and accurately reflect the current state."
      },
      {
        "id": "T-004",
        "title": "Complete Helius and Oracle integration",
        "implementationGuide": "1. Review the handoff documentation to identify the specific integration points. 2. Locate the Helius module and integrate it into the market creation flow. 3. Locate the Oracle module and integrate it into the market creation flow. 4. Ensure data flows correctly between the modules during the market creation process.",
        "filesLikelyChanged": [
          "src/market/creation/flow.ts",
          "src/integrations/helius.ts",
          "src/integrations/oracle.ts"
        ],
        "testingNotes": "Perform an end-to-end test of the market creation flow to verify that both Helius and Oracle modules function correctly within the pipeline."
      },
      {
        "id": "T-005",
        "title": "Implement proxy wallet authentication",
        "implementationGuide": "1. Open `src/polymarket/client.ts`. 2. Find the TODO comment regarding proxy wallet support. 3. Implement the necessary authentication logic to support proxy wallets (likely involving header forwarding or specific signing logic). 4. Remove the TODO comment.",
        "filesLikelyChanged": [
          "src/polymarket/client.ts"
        ],
        "testingNotes": "Test the authentication flow using a proxy wallet to ensure successful connection and request handling."
      },
      {
        "id": "T-006",
        "title": "Add synthesis test note",
        "implementationGuide": "1. Identify the designated location for synthesis test notes (likely a test directory or specific documentation file). 2. Add the requested test note.",
        "filesLikelyChanged": [
          "tests/synthesis/notes.md"
        ],
        "testingNotes": "Verify the note appears in the correct location."
      }
    ]
  },
  "prompt": "You are an AI coding agent working on the repository `nomnom-markets/polymarket-aggregator`. Your task is to implement the changes defined in the attached specification.\n\n**Priority Order:**\n1. **Critical:** T-001 (Fix order reconciliation logic). This is a blocker for other tasks.\n2. **High:** T-002 (Deploy async price cache). Ensure dependencies (PR #155) are met.\n3. **Medium:** T-004 (Helius/Oracle integration) and T-003 (Documentation).\n4. **Low:** T-005 (Proxy wallet) and T-006 (Test note).\n\n**General Instructions:**\n- Read the existing codebase thoroughly before making changes, especially for T-001 and T-004.\n- For T-002, focus on the configuration and health check implementation; ensure the Redis fallback logic is robust.\n- Write clean, commented code following the existing style conventions.\n- Add unit tests for T-001 to prevent regression.\n- Commit your changes with clear messages referencing the Ticket IDs (e.g., 'Fix T-001: Implement reconciliation logic').",
  "checklist": [
    "[ ] T-001: Investigate and define reconciliation logic for unimplemented TODO",
    "[ ] T-001: Implement missing reconciliation logic in reconciler.ts",
    "[ ] T-001: Verify filled quantities are calculated correctly",
    "[ ] T-001: Add unit tests for reconciliation logic",
    "[ ] T-002: Verify PR #155 is merged",
    "[ ] T-002: Deploy PR #156 to production",
    "[ ] T-002: Confirm /v1/prices/health returns healthy status",
    "[ ] T-002: Document and test Redis failure fallback behavior",
    "[ ] T-002: Monitor logs for concurrency-limited CLOB API calls",
    "[ ] T-003: Document status of creator flow in agent.md",
    "[ ] T-003: Document status of liquidity seeding in agent.md",
    "[ ] T-003: Document general progress on price action markets in agent.md",
    "[ ] T-004: Integrate Helius module into market creation flow",
    "[ ] T-004: Integrate Oracle module into market creation flow",
    "[ ] T-004: Verify end-to-end functionality of integrated flow",
    "[ ] T-005: Remove TODO comment from src/polymarket/client.ts",
    "[ ] T-005: Implement proxy wallet authentication logic",
    "[ ] T-005: Test authentication flow",
    "[ ] T-006: Add test note to designated location"
  ],
  "mobileNote": "Fix critical reconciler bug (T-001), deploy Redis price cache (T-002), integrate Helius/Oracle (T-004), update docs (T-003)."
}