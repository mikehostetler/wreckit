{
  "schema_version": 1,
  "id": "076-implement-remote-tool-proxy",
  "title": "Implement Remote Tool Proxy for Sprite Agents",
  "section": "infrastructure",
  "state": "critique",
  "overview": "Implement a proxy layer that redirects standard agent tools (Bash, Read, Write, Glob, Grep) to execute inside a remote Sprite VM via `sprite exec`. This transforms the `SpriteAgent` into a fully functional, sandboxed runtime environment where agents operate safely in isolation from the host filesystem.",
  "branch": null,
  "pr_url": null,
  "pr_number": null,
  "last_error": "Not all stories are done",
  "created_at": "2026-01-28T01:30:00.000Z",
  "updated_at": "2026-01-28T02:05:48.933Z",
  "problem_statement": "Currently, setting `agent.kind: \"sprite\"` only verifies connectivity. It does not actually run the agent's work inside the VM. To achieve true sandboxing, the agent's tools must be intercepted and executed remotely.",
  "motivation": "To enable safe, ephemeral agent execution where 'rm -rf /' destroys a disposable microVM, not the user's laptop.",
  "success_criteria": [
    "`runSpriteAgent` initializes a Sprite VM (or connects to an existing one)",
    "Standard tools (Bash, Read, Write, Glob, Grep) are proxied to `sprite exec` calls",
    "File content reading/writing handles binary data and escaping correctly (likely via base64)",
    "The agent can successfully run a basic task (e.g., 'create a file and check its content') inside the VM"
  ],
  "technical_constraints": [
    "Must use existing `execSprite` primitive",
    "Must be compatible with existing RLM tool interfaces",
    "Must handle latency and timeouts gracefully"
  ],
  "scope_in_scope": [
    "src/agent/sprite-runner.ts",
    "src/agent/remote-tools.ts",
    "src/agent/dispatcher.ts"
  ],
  "scope_out_of_scope": [
    "Full file synchronization (rsyncing host project to VM) - this is a future task",
    "Interactive TTY proxying"
  ],
  "priority_hint": "high",
  "urgency_hint": "Required to make sandbox mode useful"
}
